<!DOCTYPE html>
<html>
<head>
  <title>JSON Processor</title>
  <style>
    .resource {
      border: 1px solid #ccc;
      padding: 10px;
      margin-bottom: 10px;
    }
    .resourceName {
      cursor: pointer;
      font-weight: bold;
      color: blue;
    }
    .resourceDetails {
      display: none;
      margin-top: 10px;
    }
    .additionalInfoBtn {
      cursor: pointer;
      text-decoration: underline;
      color: blue;
    }
  </style>
</head>
<body>
<h1>JSON Processor</h1>
<textarea id="jsonInput" rows="10" cols="50"></textarea><br><br>
<button onclick="sendJson()">Submit</button>
<div id="output"></div>

<script>
  function sendJson() {
    const jsonInput = document.getElementById('jsonInput').value;

    fetch('http://localhost:8080/process-json', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: jsonInput
    })
            .then(response => response.json())
            .then(data => displayOutput(data))
            .catch(error => console.error('Error:', error));
  }

  function displayOutput(data) {
    const outputDiv = document.getElementById('output');
    outputDiv.innerHTML = '';

    const resources = data.Resources;
    for (const key in resources) {
      const resource = resources[key];
      const resourceDiv = document.createElement('div');
      resourceDiv.classList.add('resource');

      const resourceName = document.createElement('h2');
      resourceName.classList.add('resourceName');
      resourceName.textContent = key;
      resourceName.addEventListener('click', () => toggleDetails(resourceName));

      const resourceDetails = document.createElement('div');
      resourceDetails.classList.add('resourceDetails');

      const typeAndPrice = document.createElement('div');
      typeAndPrice.innerHTML = `
        <p>Type: ${resource.Type}</p>
        ${resource.Price !== undefined ? `<p>Price: ${resource.Price}</p>` : ''}
      `;

      const additionalInfoBtn = document.createElement('span');
      additionalInfoBtn.classList.add('additionalInfoBtn');
      additionalInfoBtn.textContent = 'Additional Info';
      additionalInfoBtn.addEventListener('click', () => toggleInfo(resourceDetails));

      resourceDetails.appendChild(typeAndPrice);

      const resourceInfo = `
        <pre>${formatProperties(resource.properties, 0)}</pre>
      `;

      resourceDetails.innerHTML += resourceInfo;

      resourceDiv.appendChild(resourceName);
      resourceDiv.appendChild(resourceDetails);
      outputDiv.appendChild(resourceDiv);
    }
  }

  function toggleDetails(resourceName) {
    const details = resourceName.nextElementSibling;
    details.style.display = details.style.display === 'none' ? 'block' : 'none';
  }

  function toggleInfo(resourceDetails) {
    resourceDetails.style.display = resourceDetails.style.display === 'none' ? 'block' : 'none';
  }

  function formatProperties(properties, indentLevel) {
    let formattedProperties = '';

    for (const prop in properties) {
      const formattedValue = formatValue(properties[prop], indentLevel);
      formattedProperties += `${getIndentation(indentLevel)}${formatKey(prop)}: ${formattedValue}\n`;
    }

    return formattedProperties;
  }

  function formatKey(key) {
    return key.split(' ').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');
  }

  function formatValue(value, indentLevel) {
    if (typeof value === 'object' && value !== null && !Array.isArray(value)) {
      return `\n${formatProperties(value, indentLevel + 1)}`;
    } else if (Array.isArray(value)) {
      return value.map(item => `${getIndentation(indentLevel)}${formatValue(item, indentLevel + 1)}`).join('\n');
    } else {
      return value;
    }
  }

  function getIndentation(indentLevel) {
    return ' '.repeat(indentLevel * 4); // Adjust the spaces for indentation as needed
  }


</script>
</body>
</html>
